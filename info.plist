<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
	<key>bundleid</key>
	<string>com.alfred.sinled.fuji-exif-rename</string>
	<key>category</key>
	<string>Tools</string>
	<key>connections</key>
	<dict>
		<key>2D500249-61F4-45C5-B9D5-ECD1CDF58A74</key>
		<array>
			<dict>
				<key>destinationuid</key>
				<string>3A29BB60-C8EF-44F1-9610-2B1B1771DD68</string>
				<key>modifiers</key>
				<integer>0</integer>
				<key>modifiersubtext</key>
				<string></string>
				<key>vitoclose</key>
				<false/>
			</dict>
		</array>
		<key>3A29BB60-C8EF-44F1-9610-2B1B1771DD68</key>
		<array>
			<dict>
				<key>destinationuid</key>
				<string>E2EC549B-046B-4FCC-B9A3-5E795D4E94C2</string>
				<key>modifiers</key>
				<integer>0</integer>
				<key>modifiersubtext</key>
				<string></string>
				<key>vitoclose</key>
				<false/>
			</dict>
			<dict>
				<key>destinationuid</key>
				<string>8776791B-7CD3-40B1-AB83-71FA0EA459C1</string>
				<key>modifiers</key>
				<integer>0</integer>
				<key>modifiersubtext</key>
				<string></string>
				<key>vitoclose</key>
				<false/>
			</dict>
		</array>
	</dict>
	<key>createdby</key>
	<string>Sinled</string>
	<key>description</key>
	<string>Rename Fuji files to add film simulations and other meta information to file</string>
	<key>disabled</key>
	<false/>
	<key>name</key>
	<string>My Fuji Exif Rename</string>
	<key>objects</key>
	<array>
		<dict>
			<key>config</key>
			<dict>
				<key>concurrently</key>
				<false/>
				<key>escaping</key>
				<integer>68</integer>
				<key>script</key>
				<string>#!/usr/bin/env bash

# workflow booleans: rename_files, write_log
flags=()

if [[ "${rename_files}" == "1" ]]; then
  flags+=(--rename)
fi
if [[ "${write_log}" == "1" ]]; then
  flags+=(-v)
fi

if [[ -n "${user_custom_recipes}" ]]; then
  flags+=(--recipes-json "${user_custom_recipes}")
fi

# run the tool with any flags, and all selected files
python3 xt5_exif_tool.py "${flags[@]}" "$@"</string>
				<key>scriptargtype</key>
				<integer>1</integer>
				<key>scriptfile</key>
				<string></string>
				<key>type</key>
				<integer>0</integer>
			</dict>
			<key>type</key>
			<string>alfred.workflow.action.script</string>
			<key>uid</key>
			<string>3A29BB60-C8EF-44F1-9610-2B1B1771DD68</string>
			<key>version</key>
			<integer>2</integer>
		</dict>
		<dict>
			<key>config</key>
			<dict>
				<key>acceptsmulti</key>
				<integer>1</integer>
				<key>filetypes</key>
				<array>
					<string>com.fuji.raw-image</string>
					<string>public.heic</string>
					<string>public.heif</string>
					<string>public.jpeg</string>
				</array>
				<key>name</key>
				<string>EXIF Rename</string>
			</dict>
			<key>type</key>
			<string>alfred.workflow.trigger.action</string>
			<key>uid</key>
			<string>2D500249-61F4-45C5-B9D5-ECD1CDF58A74</string>
			<key>version</key>
			<integer>1</integer>
		</dict>
		<dict>
			<key>config</key>
			<dict>
				<key>lastpathcomponent</key>
				<false/>
				<key>onlyshowifquerypopulated</key>
				<false/>
				<key>removeextension</key>
				<false/>
				<key>text</key>
				<string>{query}</string>
				<key>title</key>
				<string>Results</string>
			</dict>
			<key>type</key>
			<string>alfred.workflow.output.notification</string>
			<key>uid</key>
			<string>E2EC549B-046B-4FCC-B9A3-5E795D4E94C2</string>
			<key>version</key>
			<integer>1</integer>
		</dict>
		<dict>
			<key>config</key>
			<dict>
				<key>autopaste</key>
				<false/>
				<key>clipboardtext</key>
				<string>{query}</string>
				<key>ignoredynamicplaceholders</key>
				<false/>
				<key>transient</key>
				<false/>
			</dict>
			<key>type</key>
			<string>alfred.workflow.output.clipboard</string>
			<key>uid</key>
			<string>8776791B-7CD3-40B1-AB83-71FA0EA459C1</string>
			<key>version</key>
			<integer>3</integer>
		</dict>
	</array>
	<key>readme</key>
	<string># Fujifilm EXIF Renamer (with Recipes)

A tiny Python + exiftool helper to **inspect EXIF** and **rename photos** based on camera settings.  
Optionally matches your shots against **custom “recipes”** (Vibrant Arizona, Reggie's Portra and some other of the recipes that I am using) and uses the recipe name in the filename.

---

## Installation

You will need [Alfred with powerpack](https://www.alfredapp.com/powerpack/) and [exiftool](https://formulae.brew.sh/formula/exiftool) installed.

Download alfred workflow from this repo and add it to Alfred.

## Name Tags

This utility will add the following tags to the filename:

- `HDR` from **PictureMode**
- **SequenceNumber** (always, if &gt; 0): `[01]`
- **DriveMode**: `[CL01]`, `[CH01]`, or `[EB01]` if present 
- **Film simulation** from **FilmMode** or a matching **Recipe** name, if recipe settings are found.

## Custom Recipes

Fuji doesn't provide information about custom recipe name or index, but we can deduce it from the settings.

By default, detection of the next recipes is included:
- Reggies Portra
- Alpine Negative
- Cinestill 500T
- Classic Cuban Neg
- Leica X
- Vibrant Arizona

You can add your own recipes in alfred workflow settings, here are example of custom recipe:

```json
[
    {
        "name": "Reggies Portra",
        "settings": {
            "FilmMode": "Classic Chrome",
            "DynamicRangeSetting": "Auto",
            "HighlightTone": "-1 (medium soft)",
            "ShadowTone": "-1 (medium soft)",
            "Saturation": "+2 (high)",
            "NoiseReduction": "-4 (weakest)",
            "Sharpness": "Soft",
            "Clarity": 0,
            "GrainEffectRoughness": "Weak",
            "GrainEffectSize": "Small",
            "ColorChromeEffect": "Strong",
            "ColorChromeFXBlue": "Weak",
            "WhiteBalance": "Auto",
            "WhiteBalanceFineTune": "Red +40, Blue -80"
        }
    },
    {
        "name": "Vibrant Arizona",
        "settings": {
            "FilmMode": "Classic Chrome",
            "DRangePriority": "Fixed",
            "DRangePriorityAuto": "Strong",
            "HighlightTone": "0 (normal)",
            "ShadowTone": "0 (normal)",
            "Saturation": "+4 (highest)",
            "NoiseReduction": "-4 (weakest)",
            "Sharpness": "Soft",
            "Clarity": -3,
            "ColorChromeEffect": "Off",
            "ColorChromeFXBlue": "Weak",
            "GrainEffectRoughness": "Weak",
            "GrainEffectSize": "Small",
            "WhiteBalance": "Manual",
            "ColorTemperature": 4350,
            "WhiteBalanceFineTune": "Red +120, Blue -160"
        }
    }
]
```

Make sure you have correct JSON before pasting it into the workflow settings. You can check correct values by enabling **Write log** in the workflow settings and checking the log output in workflow directory or by uploading a photo to some online EXIF viewer e.g. `https://jimpl.com` or some other.

If this tool is not applying recipe name after you added it, check log file, it will print out all the settings that it is trying to match against your recipe.</string>
	<key>uidata</key>
	<dict>
		<key>2D500249-61F4-45C5-B9D5-ECD1CDF58A74</key>
		<dict>
			<key>xpos</key>
			<real>30</real>
			<key>ypos</key>
			<real>205</real>
		</dict>
		<key>3A29BB60-C8EF-44F1-9610-2B1B1771DD68</key>
		<dict>
			<key>xpos</key>
			<real>200</real>
			<key>ypos</key>
			<real>205</real>
		</dict>
		<key>8776791B-7CD3-40B1-AB83-71FA0EA459C1</key>
		<dict>
			<key>xpos</key>
			<real>380</real>
			<key>ypos</key>
			<real>325</real>
		</dict>
		<key>E2EC549B-046B-4FCC-B9A3-5E795D4E94C2</key>
		<dict>
			<key>xpos</key>
			<real>375</real>
			<key>ypos</key>
			<real>205</real>
		</dict>
	</dict>
	<key>userconfigurationconfig</key>
	<array>
		<dict>
			<key>config</key>
			<dict>
				<key>default</key>
				<true/>
				<key>required</key>
				<false/>
				<key>text</key>
				<string>Enable</string>
			</dict>
			<key>description</key>
			<string>If Disabled alfred will just list new names in notification and workflow debug</string>
			<key>label</key>
			<string>Rename files</string>
			<key>type</key>
			<string>checkbox</string>
			<key>variable</key>
			<string>rename_files</string>
		</dict>
		<dict>
			<key>config</key>
			<dict>
				<key>default</key>
				<false/>
				<key>required</key>
				<false/>
				<key>text</key>
				<string>Enable</string>
			</dict>
			<key>description</key>
			<string>Information log will be saved inside workflow directory (will grow depending on number of files)</string>
			<key>label</key>
			<string>Write Log</string>
			<key>type</key>
			<string>checkbox</string>
			<key>variable</key>
			<string>write_log</string>
		</dict>
		<dict>
			<key>config</key>
			<dict>
				<key>default</key>
				<string>[]</string>
				<key>required</key>
				<false/>
				<key>trim</key>
				<true/>
				<key>verticalsize</key>
				<integer>9</integer>
			</dict>
			<key>description</key>
			<string>As Fuji is not storing recipes names in EXIF, we can manually detect recipe from its settings strored in image EXIF. See documentation on Github for correct format</string>
			<key>label</key>
			<string>Custom Recipes JSON</string>
			<key>type</key>
			<string>textarea</string>
			<key>variable</key>
			<string>user_custom_recipes</string>
		</dict>
	</array>
	<key>variablesdontexport</key>
	<array/>
	<key>version</key>
	<string>0.0.2</string>
	<key>webaddress</key>
	<string>https://github.com/Sinled</string>
</dict>
</plist>
